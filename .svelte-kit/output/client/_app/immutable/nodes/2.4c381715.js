import{s as _,m as h,a as w,o as M,f,g as v,i as b,p as E}from"../chunks/scheduler.953cfe2b.js";import{S as C,i as P,b as S,c as $,a as y,m as A,t as k,d as O,e as R}from"../chunks/index.1fa04a18.js";import{P as j,e as m,g as I,E as N}from"../chunks/forms.af2b0274.js";import{b as g}from"../chunks/singletons.021c165b.js";import{f as p,C as T,p as q}from"../chunks/pendingMessage.dfacf87f.js";function B(n){let i,t,a,r;document.title=j;function l(e){n[4](e)}let d={loading:n[1],currentModel:p([...n[0].models,...n[0].oldModels],n[0].settings.activeModel),models:n[0].models,settings:n[0].settings};return n[2]!==void 0&&(d.files=n[2]),t=new T({props:d}),h.push(()=>S(t,"files",l)),t.$on("message",n[5]),{c(){i=w(),$(t.$$.fragment)},l(e){M("svelte-1o4lg8n",document.head).forEach(f),i=v(e),y(t.$$.fragment,e)},m(e,o){b(e,i,o),A(t,e,o),r=!0},p(e,[o]){const s={};o&2&&(s.loading=e[1]),o&1&&(s.currentModel=p([...e[0].models,...e[0].oldModels],e[0].settings.activeModel)),o&1&&(s.models=e[0].models),o&1&&(s.settings=e[0].settings),!a&&o&4&&(a=!0,s.files=e[2],E(()=>a=!1)),t.$set(s)},i(e){r||(k(t.$$.fragment,e),r=!0)},o(e){O(t.$$.fragment,e),r=!1},d(e){e&&f(i),R(t,e)}}}function G(n,i,t){let{data:a}=i,r=!1,l=[];async function d(s){try{t(1,r=!0);const c=await fetch(`${g}/conversation`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:a.settings.activeModel,preprompt:a.settings.customPrompts[a.settings.activeModel]})});if(!c.ok){m.set("Error while creating conversation, try again."),console.error("Error while creating conversation: "+await c.text());return}const{conversationId:u}=await c.json();q.set({content:s,files:l}),await I(`${g}/conversation/${u}`,{invalidateAll:!0})}catch(c){m.set(N.default),console.error(c)}finally{t(1,r=!1)}}function e(s){l=s,t(2,l)}const o=s=>d(s.detail);return n.$$set=s=>{"data"in s&&t(0,a=s.data)},[a,r,l,d,e,o]}class D extends C{constructor(i){super(),P(this,i,G,B,_,{data:0})}}export{D as component};
